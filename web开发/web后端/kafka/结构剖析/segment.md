# segment定义

# segment结构
- 由一对文件组成，一个**稀疏索引文件**(.index)，一个**数据文件**(.log)，一个**时间索引文件**(.timeindex)

- 文件命名规则：
  1. 上一个segment在partition中的最大offset数值，即，比如 0000000000000345678.log文件中的第一条消息的offset为 *345679*
  2. 最大为64位的long，不足位数补0，如000000000000000345678.log
  3. 索引文件后缀.index，日志数据文件后缀.log


# segment索引文件结构(.index)
- 存储一系列的元数据，每条元数据就是一条索引
- 元数据条数小于信息条数，是稀疏索引
- 元数据（即索引）构成：
  1. 索引所指向的message在数据日志文件中的相对序号，即相对的offset，从 1 开始，该相对offset加上文件名当中的值就是该message在整个partition中的绝对offset了
  2. 索引所指向的message在数据日志文件中的位置，即文件游标，从0开始，方便直接指定游标打开数据文件
